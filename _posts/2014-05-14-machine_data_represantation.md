---
layout: post
title: "数据机器级表示的缺陷"
description: ""
categories: ["基础知识"]
tags: ["数据的机器表示","C++"]
published: true
---

{% include JB/setup %}

先看一组简单到不行的数学题：

    1e20+(-1e20)+3.14=  ?
    1e20+(-1e20+3.14)=  ?
           4000*4000>0  ?
         50000*50000>0  ?

只需要小学的知识就可以得到结果，但是如果是让计算机给我们算呢？

    #include <iostream>
    using namespace std;
    
    int main()
    {
        float i=1e20,j=-1e20,k=3.14;
        cout<<"1e20+(-1e20)+3.14="<<i+j+k<<endl;
        cout<<"1e20+(-1e20+3.14)="<<i+(j+k)<<endl;
        int m=4000,n=50000;
        cout<<"4000*4000>0 ? "<<(m*m>0)<<endl;
        cout<<"50000*50000>0 ? "<<(n*n>0)<<endl;
        cout << "Hello World!" << endl;
        return 0;
    }

用上面的c++代码计算出来的结果是这样的：

    1e20+(-1e20)+3.14= 3.14
    1e20+(-1e20+3.14)= 0
         4000*4000>0 ? 1
       50000*50000>0 ? 0

三个数不同顺序加出来的结果竟然不一样，两个正数相乘结果竟然为负了。这显然和我们通常的数学理论不一致。为什么会这样呢？因为在计算机中是用有限位来表示数据的，计算的时候并不一定能达到我们期望的精度，因此在编写程序的时候要注意，不能因为这种问题影响程序的正确性。

